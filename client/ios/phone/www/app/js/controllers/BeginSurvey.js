/**
 *
 * @author Schubert Generated Code</br>
 * Date Created: </br>
 * @since  </br>
   build:   </p>
 *
 * code was generated by the Schubert System </br>
 * Schubert system Copyright - NewPortBay LLC copy_right_range</br>
 * The generated code is free to use by anyone</p>
 *
 *
 *
*/

app.controller('BeginSurveyCtrl', [ '$scope', '$rootScope', '$location', '$window', '$q', '$http','surveyFactory','$cordovaSQLite','$timeout','$state','surveyService','$ionicPopup',function( $scope, $rootScope, $location, $window, $q, $http,surveyFactory,$cordovaSQLite,$timeout,$state,surveyService,$ionicPopup) {

		var self = $scope;
		$scope.surveyId = 1;
		self.surveyFactory =[];
		self.surveyResult =[];
		$rootScope.surveyId ='';


	$scope.doSurvey =function(survey){
		//console.log("do survey--" +angular.toJson(survey));
		//alert("Survey Id-" +angular.toJson(survey.Id));
		$rootScope.surveyId =survey.Id;
				surveyFactory.setisEnd(false);
				surveyFactory.setNextquestionId(0);
				surveyFactory.setQuestion('{}');
			/*	var promise = firstQuestionWithOptions();
					promise.then(function(res) {	
					console.log("---oprtino in promise--"+angular.toJson(res));
					//alert('Success promice: '+surveyFactory.getNextquestionId()+"options inside init"+angular.toJson(surveyFactory.getQuestionOptions()));
			}, function(reason) {
				alert('Failed: ' + reason);
			});*/


		console.log("------$rootScope.surveyId----",$rootScope.surveyId);
		$scope.surveyId =  $rootScope.surveyId;
		// TODO: call from factory. Survey questions must not be loaded again
		surveyService.getAllQuestionsForASurvey(survey.Id).then(function(res){
			console.log("-------------res=="+angular.toJson(res));

		for (var i = 0; i < res.length; i++) {
			console.log(res[i].The_question);
		};
			//console.log("--rrrrrquestion---"+res.id);
			//console.log("--option rrr---"+angular.toJson($scope.option));
		});
		$state.go("begin-questionare");
}

		$scope.init=function(){
		/*	if(surveyFactory.getisEnd()==true){
				//$window.location.reload(true);
				surveyFactory.setisEnd(false);
				surveyFactory.setNextquestionId(0);
				surveyFactory.setQuestion('{}');
			}*/
  
			surveyService.getSurvey().then(function(res){
				self.surveyResult = res;
				console.log("------A-"+angular.toJson(self.surveyResult));
			}); 
	}
		$scope.init();
}]);


